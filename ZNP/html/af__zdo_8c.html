<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Zigbee Network Processor Library: af_zdo.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.3 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>af_zdo.c File Reference</h1>
<p>Methods that implement the CC2530ZNP Application Framework / Zigbee Device Objects (AF/ZDO) interface.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="af__zdo_8c.html">af_zdo.h</a>&quot;</code><br/>
<code>#include &quot;msp430x22x4.h&quot;</code><br/>
<code>#include &lt;stdarg.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="application__configuration_8h.html">application_configuration.h</a>&quot;</code><br/>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0ee1982eeed9bc90a8b280b561ed6d12"></a><!-- doxytag: member="af_zdo.c::AF_REGISTER_PAYLOAD_LEN" ref="a0ee1982eeed9bc90a8b280b561ed6d12" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>AF_REGISTER_PAYLOAD_LEN</b>&nbsp;&nbsp;&nbsp;9</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4a4cdc4be39b55eea03e9eb035b49f6c"></a><!-- doxytag: member="af_zdo.c::ZDO_STARTUP_FROM_APP_PAYLOAD_LEN" ref="a4a4cdc4be39b55eea03e9eb035b49f6c" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>ZDO_STARTUP_FROM_APP_PAYLOAD_LEN</b>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4add0d7e47f7de59cf9ba4c9145291d9"></a><!-- doxytag: member="af_zdo.c::NO_START_DELAY" ref="a4add0d7e47f7de59cf9ba4c9145291d9" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>NO_START_DELAY</b>&nbsp;&nbsp;&nbsp;0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afdddcac5ecc17e740a9941f0310ddbc4"></a><!-- doxytag: member="af_zdo.c::AF_DATA_CONFIRM_TIMEOUT" ref="afdddcac5ecc17e740a9941f0310ddbc4" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>AF_DATA_CONFIRM_TIMEOUT</b>&nbsp;&nbsp;&nbsp;2</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aaef7d6703fd16954254509998e714b4b"></a><!-- doxytag: member="af_zdo.c::AF_DATA_REQUEST_PAYLOAD_LEN" ref="aaef7d6703fd16954254509998e714b4b" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>AF_DATA_REQUEST_PAYLOAD_LEN</b>&nbsp;&nbsp;&nbsp;10</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a02c8e2df19f087b1e4561d590681079f"></a><!-- doxytag: member="af_zdo.c::ZDO_IEEE_ADDR_REQ_PAYLOAD_LEN" ref="a02c8e2df19f087b1e4561d590681079f" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>ZDO_IEEE_ADDR_REQ_PAYLOAD_LEN</b>&nbsp;&nbsp;&nbsp;4</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a963ac5c353b992c007b7f788a141bd1e"></a><!-- doxytag: member="af_zdo.c::ZDO_NWK_ADDR_REQ_PAYLOAD_LEN" ref="a963ac5c353b992c007b7f788a141bd1e" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><b>ZDO_NWK_ADDR_REQ_PAYLOAD_LEN</b>&nbsp;&nbsp;&nbsp;10</td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="af__zdo_8c.html#a08831fd10f90fb1a8ebc9beaabe2dda8">afRegisterApplication</a> (struct <a class="el" href="structapplication_configuration.html">applicationConfiguration</a> ac)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="af__zdo_8c.html#a256f5d6b25d342a4aedfd857dc17191f">afRegisterGenericApplication</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="af__zdo_8c.html#acce74ca8d4d79b2db523e233f9c16397">zdoStartApplication</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="af__zdo_8c.html#a81b17d71af983bca7f455cde99d908e9">afSendData</a> (unsigned char destinationEndpoint, unsigned char sourceEndpoint, unsigned int destinationShortAddress, unsigned int clusterId, unsigned char *data, unsigned char dataLength)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="af__zdo_8c.html#ade72a57e6e4b5472c7f8e82ca091c03a">zdoRequestIeeeAddress</a> (unsigned int shortAddress, unsigned char requestType, unsigned char startIndex)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="af__zdo_8c.html#aad73679c1d41d80022e59101097d2a24">zdoNetworkAddressRequest</a> (unsigned char *ieeeAddress, unsigned char requestType, unsigned char startIndex)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">signed int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="af__zdo_8c.html#aa0c2ae1a36fc76c872ff6b52400c9a75">printAfIncomingMsgHeader</a> (unsigned char *srsp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="af__zdo_8c.html#af3ec84d22596740e6501194f5b73b7ba">printAfIncomingMsgHeaderNames</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="af__zdo_8c.html#a89ef2bec238de297a528dd04252302b0">printZdoNetworkAddressResponse</a> (unsigned char *rsp)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="af__zdo_8c.html#a9ccc00afc7b349d6a57b6cfbfee8fa77">znpBuf</a> [100]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="af__zdo_8c.html#aec8202f323374bc8804a1361e892b63c">transactionSequenceNumber</a> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa95942e82f7a0310ea90e05982f3cf67"></a><!-- doxytag: member="af_zdo.c::znpResult" ref="aa95942e82f7a0310ea90e05982f3cf67" args="" -->
signed int&nbsp;</td><td class="memItemRight" valign="bottom"><b>znpResult</b></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Methods that implement the CC2530ZNP Application Framework / Zigbee Device Objects (AF/ZDO) interface. </p>
<p>The AF/ZDO interface is a more powerful version of the Simple API and allows you to configure, send, and receive Zigbee data. This file acts as an interface between the user's application and the ZNP physical interface. RFIC interface could be either SPI or UART. Refer to Interface Specification for more information.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>For more information, define AF_ZDO_VERBOSE. It is recommended to define this on a per-project basis. In IAR, this can be done in Project Options : C/C++ compiler : Preprocessor In the defined symbols box, add: AF_ZDO_VERBOSE</dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a href="http://processors.wiki.ti.com/index.php/Tutorial_on_the_Examples">http://processors.wiki.ti.com/index.php/Tutorial_on_the_Examples</a> and <a href="http://e2e.ti.com/support/low_power_rf/default.aspx">http://e2e.ti.com/support/low_power_rf/default.aspx</a></dd></dl>
<dl class="rcs"><dt><b>Rev</b></dt><dd>601 </dd></dl>
<dl class="rcs"><dt><b>Author</b></dt><dd>dsmith </dd></dl>
<dl class="rcs"><dt><b>Date</b></dt><dd>2010-06-16 13:09:21 -0700 (Wed, 16 Jun 2010) </dd></dl>
<p>YOU ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE, NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT, NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS. </p>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a08831fd10f90fb1a8ebc9beaabe2dda8"></a><!-- doxytag: member="af_zdo.c::afRegisterApplication" ref="a08831fd10f90fb1a8ebc9beaabe2dda8" args="(struct applicationConfiguration ac)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void afRegisterApplication </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structapplication_configuration.html">applicationConfiguration</a>&nbsp;</td>
          <td class="paramname"> <em>ac</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Configures the ZNP for our application. Sets which profileId, etc. we're using as well as binding information FOR EACH ENDPOINT Using the AF/ZDO interface, you can have more than one endpoint. Recommended not to exceed 10 endpoints. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ac</em>&nbsp;</td><td>the <a class="el" href="structapplication_configuration.html">applicationConfiguration</a> to register. </td></tr>
  </table>
  </dd>
</dl>
<dl class="pre"><dt><b>Precondition:</b></dt><dd>znp was initialized and ZCD_NV_LOGICAL_TYPE has been set (COORDINATOR/ROUTER/END_DEVICE). </dd></dl>
<dl class="post"><dt><b>Postcondition:</b></dt><dd>znpResult contains the error code, or ZNP_SUCCESS if success. </dd>
<dd>
can now use afStartApplication() </dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>this method does not check whether the endpoint being registered has already been registered - it is up to the application to manage that. </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="structapplication_configuration.html">applicationConfiguration</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a256f5d6b25d342a4aedfd857dc17191f"></a><!-- doxytag: member="af_zdo.c::afRegisterGenericApplication" ref="a256f5d6b25d342a4aedfd857dc17191f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void afRegisterGenericApplication </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Configures the ZNP for a "generic" application: one endpoint, no binding or fancy stuff. Sets which endpoint, profileId, etc. we're using as well as binding information </p>
<dl class="post"><dt><b>Postcondition:</b></dt><dd>znpResult contains the error code, or ZNP_SUCCESS if success. </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="af__zdo_8c.html#a08831fd10f90fb1a8ebc9beaabe2dda8">afRegisterApplication()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a81b17d71af983bca7f455cde99d908e9"></a><!-- doxytag: member="af_zdo.c::afSendData" ref="a81b17d71af983bca7f455cde99d908e9" args="(unsigned char destinationEndpoint, unsigned char sourceEndpoint, unsigned int destinationShortAddress, unsigned int clusterId, unsigned char *data, unsigned char dataLength)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void afSendData </td>
          <td>(</td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>destinationEndpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>sourceEndpoint</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>destinationShortAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>clusterId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>dataLength</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sends a message to another device over the Zigbee network using the AF command AF_DATA_REQUEST. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>destinationEndpoint</em>&nbsp;</td><td>which endpoint to send this to. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sourceEndpoint</em>&nbsp;</td><td>which endpoint this message originated from on our device </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>destinationShortAddress</em>&nbsp;</td><td>the short address of the destination, or ALL_DEVICES or ALL_ROUTERS_AND_COORDINATORS to broadcast the message. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>clusterId</em>&nbsp;</td><td>which cluster this message is for. User definable. Zigbee supports up to 2^16 clusters. A cluster is typically a particular command, e.g. "turn on lights" or "get temperature". If using a predefined Zigbee Alliance Application Profile then this cluster will follow the Zigbee Cluster Library. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data</em>&nbsp;</td><td>is the data to send. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dataLength</em>&nbsp;</td><td>is how many bytes of data to send. Must be less than MAXIMUM_PAYLOAD_LENGTH. </td></tr>
  </table>
  </dd>
</dl>
<dl class="note"><dt><b>Note:</b></dt><dd>On a coordinator in a trivial test setup, it takes approximately 10mSec from sending AF_DATA_REQUEST to when we receive AF_DATA_CONFIRM. </dd>
<dd>
<code>transactionSequenceNumber</code> is an optional user-definable reference number to match AF_DATA_REQUEST messages with AF_DATA_CONFIRM messages. </dd>
<dd>
The ZNP will automatically require an ACK from the next device on the route when sending data. To require an ACK from the final destination, change MAC_ACK to APS_ACK at the expense of increased network traffic. </dd>
<dd>
The <code>radius</code> is the maximum number of hops that this packet can travel through before it will be dropped. Should be set to the maximum number of hops expected in the network. </dd>
<dd>
adjust AF_DATA_CONFIRM_INTERVAL_MS and AF_DATA_CONFIRM_TIMEOUT_MS based on network size, number of hops, etc. </dd></dl>
<dl class="pre"><dt><b>Precondition:</b></dt><dd>the application was started successfully </dd>
<dd>
there is another device on the network with short address of <code>destinationShortAddress</code> and that device has successfully started its application. </dd></dl>
<dl class="post"><dt><b>Postcondition:</b></dt><dd>srsp will contain a AF_DATA_REQUEST_SRSP. We will receive a AF_DATA_REQUEST_SRSP regardless of whether the message was successfully sent or not. </dd>
<dd>
we will receive a AF_DATA_CONFIRM if the message was successfully sent. </dd>
<dd>
znpResult contains the error code, or ZNP_SUCCESS if success. </dd></dl>

</div>
</div>
<a class="anchor" id="aa0c2ae1a36fc76c872ff6b52400c9a75"></a><!-- doxytag: member="af_zdo.c::printAfIncomingMsgHeader" ref="aa0c2ae1a36fc76c872ff6b52400c9a75" args="(unsigned char *srsp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">signed int printAfIncomingMsgHeader </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>srsp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Displays the header information in an AF_INCOMING_MSG. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>srsp</em>&nbsp;</td><td>a pointer to the buffer containing the message </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 if success, -1 if not a AF_INCOMING_MSG. </dd></dl>

</div>
</div>
<a class="anchor" id="af3ec84d22596740e6501194f5b73b7ba"></a><!-- doxytag: member="af_zdo.c::printAfIncomingMsgHeaderNames" ref="af3ec84d22596740e6501194f5b73b7ba" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void printAfIncomingMsgHeaderNames </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Displays the names that go with the above </p>

</div>
</div>
<a class="anchor" id="a89ef2bec238de297a528dd04252302b0"></a><!-- doxytag: member="af_zdo.c::printZdoNetworkAddressResponse" ref="a89ef2bec238de297a528dd04252302b0" args="(unsigned char *rsp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void printZdoNetworkAddressResponse </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>rsp</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Prints out the returned value of <a class="el" href="af__zdo_8c.html#aad73679c1d41d80022e59101097d2a24">zdoNetworkAddressRequest()</a> </p>

</div>
</div>
<a class="anchor" id="aad73679c1d41d80022e59101097d2a24"></a><!-- doxytag: member="af_zdo.c::zdoNetworkAddressRequest" ref="aad73679c1d41d80022e59101097d2a24" args="(unsigned char *ieeeAddress, unsigned char requestType, unsigned char startIndex)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char* zdoNetworkAddressRequest </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&nbsp;</td>
          <td class="paramname"> <em>ieeeAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>requestType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>startIndex</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Requests a device's Short Address for a given long address. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>ieeeAddress</em>&nbsp;</td><td>the long address to locate </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>requestType</em>&nbsp;</td><td>must be SINGLE_DEVICE_RESPONSE or INCLUDE_ASSOCIATED_DEVICES. If SINGLE_DEVICE_RESPONSE is selected, then only information about the requested device will be returned. If INCLUDE_ASSOCIATED_DEVICES is selected, then the short addresses of the selected device's children will be returned too. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>startIndex</em>&nbsp;</td><td>If INCLUDE_ASSOCIATED_DEVICES was selected, then there may be too many children to fit in one ZDO_NWK_ADDR_RSP message. So, use startIndex to get the next set of children's short addresses. </td></tr>
  </table>
  </dd>
</dl>
<dl class="note"><dt><b>Note:</b></dt><dd>DOES NOT WORK FOR SLEEPING END DEVICES </dd></dl>
<dl class="post"><dt><b>Postcondition:</b></dt><dd>An ZDO_NWK_ADDR_RSP message will be received, with one or more entries. </dd></dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a pointer to the beginning of the payload, or a pointer to indeterminate data if error. </dd></dl>
<dl class="post"><dt><b>Postcondition:</b></dt><dd>znpResult contains the error code, or ZNP_SUCCESS if success. </dd></dl>

</div>
</div>
<a class="anchor" id="ade72a57e6e4b5472c7f8e82ca091c03a"></a><!-- doxytag: member="af_zdo.c::zdoRequestIeeeAddress" ref="ade72a57e6e4b5472c7f8e82ca091c03a" args="(unsigned int shortAddress, unsigned char requestType, unsigned char startIndex)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zdoRequestIeeeAddress </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>shortAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>requestType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&nbsp;</td>
          <td class="paramname"> <em>startIndex</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Requests a device's MAC Address (64-bit IEEE Address) given a short address. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>shortAddress</em>&nbsp;</td><td>the short address to locate </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>requestType</em>&nbsp;</td><td>must be SINGLE_DEVICE_RESPONSE or INCLUDE_ASSOCIATED_DEVICES. If SINGLE_DEVICE_RESPONSE is selected, then only information about the requested device will be returned. If INCLUDE_ASSOCIATED_DEVICES is selected, then the short addresses of the selected device's children will be returned too. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>startIndex</em>&nbsp;</td><td>If INCLUDE_ASSOCIATED_DEVICES was selected, then there may be too many children to fit in one ZDO_IEEE_ADDR_RSP message. So, use startIndex to get the next set of children's short addresses. </td></tr>
  </table>
  </dd>
</dl>
<dl class="post"><dt><b>Postcondition:</b></dt><dd>An ZDO_IEEE_ADDR_RSP message will be received, with one or more entries. </dd>
<dd>
znpResult contains the error code, or ZNP_SUCCESS if success. </dd></dl>

</div>
</div>
<a class="anchor" id="acce74ca8d4d79b2db523e233f9c16397"></a><!-- doxytag: member="af_zdo.c::zdoStartApplication" ref="acce74ca8d4d79b2db523e233f9c16397" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zdoStartApplication </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Starts the Zigbee stack in the ZNP using the settings from a previous <a class="el" href="af__zdo_8c.html#a08831fd10f90fb1a8ebc9beaabe2dda8">afRegisterApplication()</a>. After this start request process completes, the device is ready to send, receive, and route network traffic. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>On a coordinator in a trivial test setup, it takes approximately 300mSec between sending START_REQUEST and receiving START_REQUEST_SRSP and then another 200-1000mSec from when we receive START_REQUEST_SRSP to when we receive START_CONFIRM. Set START_CONFIRM_TIMEOUT based on size of your network. </dd>
<dd>
ZDO_STARTUP_FROM_APP field StartDelay not used </dd></dl>
<dl class="pre"><dt><b>Precondition:</b></dt><dd><a class="el" href="af__zdo_8c.html#a08831fd10f90fb1a8ebc9beaabe2dda8">afRegisterApplication()</a> was a success. </dd></dl>
<dl class="post"><dt><b>Postcondition:</b></dt><dd>znpResult contains the error code, or ZNP_SUCCESS if success. </dd>
<dd>
We will see Device Status change to DEV_ROUTER, DEV_ZB_COORD, or DEV_END_DEVICE correspondingly if everything was ok. </dd></dl>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="aec8202f323374bc8804a1361e892b63c"></a><!-- doxytag: member="af_zdo.c::transactionSequenceNumber" ref="aec8202f323374bc8804a1361e892b63c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char <a class="el" href="af__zdo_8c.html#aec8202f323374bc8804a1361e892b63c">transactionSequenceNumber</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Incremented for each AF_DATA_REQUEST, wraps around to 0. </p>

</div>
</div>
<a class="anchor" id="a9ccc00afc7b349d6a57b6cfbfee8fa77"></a><!-- doxytag: member="af_zdo.c::znpBuf" ref="a9ccc00afc7b349d6a57b6cfbfee8fa77" args="[100]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned char <a class="el" href="znp__util__interface_8c.html#a9ccc00afc7b349d6a57b6cfbfee8fa77">znpBuf</a>[100]</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This buffer will hold the transmitted messages and received SRSP Payload after <a class="el" href="znp__interface__spi_8c.html#a95eb4d68729b1c13e4024d276b016e88">sendMessage()</a> was called. </p>

</div>
</div>
</div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr class="footer"/><address style="text-align: right;"><small>Generated on Thu Aug 19 11:47:25 2010 for Zigbee Network Processor Library by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
